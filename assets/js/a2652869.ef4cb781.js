"use strict";(self.webpackChunkkuberocketci_docs=self.webpackChunkkuberocketci_docs||[]).push([[67772],{10831:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"operator-guide/disaster-recovery/velero-restore-platform","title":"Restore KubeRocketCI Tenant With Velero","description":"You can use the Velero tool to restore a platform tenant. Explore the main steps for backup and restoring below.","source":"@site/docs/operator-guide/disaster-recovery/velero-restore-platform.md","sourceDirName":"operator-guide/disaster-recovery","slug":"/operator-guide/disaster-recovery/velero-restore-platform","permalink":"/docs/next/operator-guide/disaster-recovery/velero-restore-platform","draft":false,"unlisted":false,"editUrl":"https://github.com/KubeRocketCI/docs/edit/main/docs/operator-guide/disaster-recovery/velero-restore-platform.md","tags":[],"version":"current","lastUpdatedBy":"Sergiy Kulanov","lastUpdatedAt":1737662090000,"frontMatter":{},"sidebar":"operatorGuideSidebar","previous":{"title":"IAM Roles for Velero Kubernetes Service Accounts","permalink":"/docs/next/operator-guide/disaster-recovery/velero-irsa"},"next":{"title":"Upgrade KubeRocketCI v3.9 to 3.10","permalink":"/docs/next/operator-guide/upgrade/upgrade-edp-3.10"}}');var n=t(74848),s=t(28453);const a={},i="Restore KubeRocketCI Tenant With Velero",l={},c=[];function d(e){const r={a:"a",code:"code",h1:"h1",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components},{Head:o}=r;return o||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"restore-kuberocketci-tenant-with-velero",children:"Restore KubeRocketCI Tenant With Velero"})}),"\n",(0,n.jsx)(o,{children:(0,n.jsx)("link",{rel:"canonical",href:"https://docs.kuberocketci.io/docs/operator-guide/disaster-recovery/velero-restore-platform/"})}),"\n",(0,n.jsx)(r.p,{children:"You can use the Velero tool to restore a platform tenant. Explore the main steps for backup and restoring below."}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Delete all related entities in ",(0,n.jsx)(r.strong,{children:"Keycloak"}),": realm and clients from ",(0,n.jsx)(r.strong,{children:"master/openshift"})," realms. Navigate to the entities list in the Keycloak, select the necessary ones, and click the deletion icon on the entity overview page.\nIf there are customized configs in Keycloak, save them before making backup."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"Remove keycloak realm",src:t(8037).A+"",title:"Remove keycloak realm",width:"1488",height:"681"})}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["To restore KubeRocketCI, install and configure the Velero tool. Please refer to the ",(0,n.jsx)(r.a,{href:"/docs/next/operator-guide/disaster-recovery/install-velero",children:"Install Velero"})," documentation for details."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Remove all locks for operators. Delete all config maps that have ",(0,n.jsx)(r.code,{children:"<OPERATOR_NAME>-operator-lock"})," names. Then restart all pods with operators, or simply run the following command:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"kubectl -n edp delete cm $(kubectl -n edp get cm | grep 'operator-lock' | awk '{print $1}')\n"})}),"\n"]}),"\n"]})]})}function p(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8037:(e,r,t)=>{t.d(r,{A:()=>o});const o=t.p+"assets/images/delete-keycloak-realm-509beb4856a54326a77b11a717f88710.png"},28453:(e,r,t)=>{t.d(r,{R:()=>a,x:()=>i});var o=t(96540);const n={},s=o.createContext(n);function a(e){const r=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),o.createElement(s.Provider,{value:r},e.children)}}}]);