"use strict";(self.webpackChunkkuberocketci_docs=self.webpackChunkkuberocketci_docs||[]).push([[30531],{24353:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>u,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"operator-guide/auth/oauth2-proxy","title":"Tekton Dashboard Authentication","description":"Guide on securing Tekton Dashboard using OAuth2-Proxy with Keycloak OIDC provider, enhancing endpoint security within KubeRocketCI.","source":"@site/docs/operator-guide/auth/oauth2-proxy.md","sourceDirName":"operator-guide/auth","slug":"/operator-guide/auth/oauth2-proxy","permalink":"/docs/next/operator-guide/auth/oauth2-proxy","draft":false,"unlisted":false,"editUrl":"https://github.com/KubeRocketCI/docs/edit/main/docs/operator-guide/auth/oauth2-proxy.md","tags":[],"version":"current","lastUpdatedBy":"Sergiy Kulanov","lastUpdatedAt":1740847812000,"frontMatter":{"title":"Tekton Dashboard Authentication","description":"Guide on securing Tekton Dashboard using OAuth2-Proxy with Keycloak OIDC provider, enhancing endpoint security within KubeRocketCI.","sidebar_label":"Tekton Dashboard Authentication"},"sidebar":"operatorGuideSidebar","previous":{"title":"EKS OIDC With Keycloak","permalink":"/docs/next/operator-guide/auth/configure-keycloak-oidc-eks"},"next":{"title":"Kubernetes Namespace Management","permalink":"/docs/next/operator-guide/auth/namespace-management"}}');var a=n(74848),o=n(28453),i=n(65537),s=n(79329);const l={title:"Tekton Dashboard Authentication",description:"Guide on securing Tekton Dashboard using OAuth2-Proxy with Keycloak OIDC provider, enhancing endpoint security within KubeRocketCI.",sidebar_label:"Tekton Dashboard Authentication"},u="Tekton Dashboard Authentication",c={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Integration OAuth2-Proxy",id:"integration-oauth2-proxy",level:2},{value:"Enable OAuth2-Proxy on Tekton Dashboard",id:"enable-oauth2-proxy-on-tekton-dashboard",level:2},{value:"Related Articles",id:"related-articles",level:2}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components},{Head:n}=t;return n||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"tekton-dashboard-authentication",children:"Tekton Dashboard Authentication"})}),"\n",(0,a.jsx)(n,{children:(0,a.jsx)("link",{rel:"canonical",href:"https://docs.kuberocketci.io/docs/operator-guide/auth/oauth2-proxy"})}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.a,{href:"https://oauth2-proxy.github.io/oauth2-proxy/",children:"OAuth2-Proxy"})," is a versatile tool that serves as a reverse proxy, utilizing the OAuth 2.0 protocol with various providers like Google, GitHub, and Keycloak to provide both authentication and authorization. This guide instructs readers on how to protect their applications' endpoints using OAuth2-Proxy. By following these steps, users can enhance the security of their endpoints without modifying their current application code. In the context of KubeRocketCI, it has integration with the Keycloak OIDC provider, enabling it to connect with any component that lacks built-in authentication."]}),"\n",(0,a.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.a,{href:"/docs/next/operator-guide/auth/keycloak",children:"Keycloak"})," with OIDC authentication is installed."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.a,{href:"/docs/next/operator-guide/add-ons-overview",children:"Keycloak operator"})," is installed."]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"integration-oauth2-proxy",children:"Integration OAuth2-Proxy"}),"\n",(0,a.jsxs)(t.p,{children:["To streamline the installation of OAuth2-Proxy in your environment, it is advised to utilize the resources available in the ",(0,a.jsx)(t.a,{href:"https://github.com/epam/edp-cluster-add-ons/tree/main/clusters/core/addons/oauth2-proxy",children:"Cluster Add-Ons"})," and their ",(0,a.jsx)(t.a,{href:"https://github.com/epam/edp-cluster-add-ons/blob/main/chart/values.yaml#L120",children:"applications"}),"."]}),"\n",(0,a.jsx)(t.h2,{id:"enable-oauth2-proxy-on-tekton-dashboard",children:"Enable OAuth2-Proxy on Tekton Dashboard"}),"\n",(0,a.jsx)(t.p,{children:"The example below illustrates how to use OAuth2-Proxy in practice when using the Tekton dashboard:"}),"\n",(0,a.jsxs)(i.A,{defaultValue:"kubernetes",values:[{label:"Kubernetes",value:"kubernetes"},{label:"Openshift",value:"openshift"}],children:[(0,a.jsxs)(s.A,{value:"kubernetes",children:[(0,a.jsxs)(t.p,{children:["Edit the Tekton dashboard Ingress annotation by adding ",(0,a.jsx)(t.code,{children:"auth-signin"})," and ",(0,a.jsx)(t.code,{children:"auth-url"})," of oauth2-proxy by ",(0,a.jsx)(t.code,{children:"kubectl"})," command:"]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"kubectl annotate ingress <application-ingress-name> \\\nnginx.ingress.kubernetes.io/auth-signin='https://<oauth-ingress-host>/oauth2/start?rd=https://$host$request_uri' \\\nnginx.ingress.kubernetes.io/auth-url='http://oauth2-proxy.oauth2-proxy.svc.cluster.local:80/oauth2/auth'\n"})})]}),(0,a.jsxs)(s.A,{value:"openshift",children:[(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:"Generate a cookie-secret for proxy with the following command:"}),"\n"]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"tekton_dashboard_cookie_secret=$(openssl rand -base64 32 | head -c 32)\n"})}),(0,a.jsxs)(t.ol,{start:"2",children:["\n",(0,a.jsxs)(t.li,{children:["Create ",(0,a.jsx)(t.code,{children:"tekton-dashboard-proxy-cookie-secret"})," in the edp namespace:"]}),"\n"]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"kubectl -n edp create secret generic tekton-dashboard-proxy-cookie-secret \\\n  --from-literal=cookie-secret=${tekton_dashboard_cookie_secret}\n"})}),(0,a.jsxs)(t.ol,{start:"3",children:["\n",(0,a.jsxs)(t.li,{children:["Run ",(0,a.jsx)(t.code,{children:"helm upgrade"})," to update edp-install release:"]}),"\n"]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"helm upgrade --version <version> --set 'edp-tekton.dashboard.openshift_proxy.enabled=true' edp-install --namespace edp\n"})})]})]}),"\n",(0,a.jsx)(t.h2,{id:"related-articles",children:"Related Articles"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"/docs/next/operator-guide/auth/keycloak",children:"Keycloak Installation"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"/docs/next/operator-guide/auth/configure-keycloak-oidc-eks",children:"Keycloak OIDC Installation"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"/docs/next/operator-guide/install-tekton",children:"Tekton Installation"})}),"\n"]})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},79329:(e,t,n)=>{n.d(t,{A:()=>i});n(96540);var r=n(34164);const a={tabItem:"tabItem_Ymn6"};var o=n(74848);function i(e){let{children:t,hidden:n,className:i}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,r.A)(a.tabItem,i),hidden:n,children:t})}},65537:(e,t,n)=>{n.d(t,{A:()=>j});var r=n(96540),a=n(34164),o=n(65627),i=n(56347),s=n(50372),l=n(30604),u=n(11861),c=n(78749);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??function(e){return d(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:a}}=e;return{value:t,label:n,attributes:r,default:a}}))}(n);return function(e){const t=(0,u.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function b(e){let{queryString:t=!1,groupId:n}=e;const a=(0,i.W6)(),o=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l.aZ)(o),(0,r.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(a.location.search);t.set(o,e),a.replace({...a.location,search:t.toString()})}),[o,a])]}function x(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,o=h(e),[i,l]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:o}))),[u,d]=b({queryString:n,groupId:a}),[x,f]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,o]=(0,c.Dv)(n);return[a,(0,r.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:a}),g=(()=>{const e=u??x;return p({value:e,tabValues:o})?e:null})();(0,s.A)((()=>{g&&l(g)}),[g]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),f(e)}),[d,f,o]),tabValues:o}}var f=n(9136);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var m=n(74848);function k(e){let{className:t,block:n,selectedValue:r,selectValue:i,tabValues:s}=e;const l=[],{blockElementScrollPositionUntilNextRender:u}=(0,o.a_)(),c=e=>{const t=e.currentTarget,n=l.indexOf(t),a=s[n].value;a!==r&&(u(t),i(a))},d=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;t=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;t=l[n]??l[l.length-1];break}}t?.focus()};return(0,m.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":n},t),children:s.map((e=>{let{value:t,label:n,attributes:o}=e;return(0,m.jsx)("li",{role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,ref:e=>{l.push(e)},onKeyDown:d,onClick:c,...o,className:(0,a.A)("tabs__item",g.tabItem,o?.className,{"tabs__item--active":r===t}),children:n??t},t)}))})}function y(e){let{lazy:t,children:n,selectedValue:o}=e;const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===o));return e?(0,r.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,m.jsx)("div",{className:"margin-top--md",children:i.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==o})))})}function v(e){const t=x(e);return(0,m.jsxs)("div",{className:(0,a.A)("tabs-container",g.tabList),children:[(0,m.jsx)(k,{...t,...e}),(0,m.jsx)(y,{...t,...e})]})}function j(e){const t=(0,f.A)();return(0,m.jsx)(v,{...e,children:d(e.children)},String(t))}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>s});var r=n(96540);const a={},o=r.createContext(a);function i(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);