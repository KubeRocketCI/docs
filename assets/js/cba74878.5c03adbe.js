"use strict";(self.webpackChunkkuberocketci_docs=self.webpackChunkkuberocketci_docs||[]).push([[22117],{86042:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"operator-guide/secrets-management/external-secrets-operator-integration","title":"External Secrets Operator Integration","description":"Guide on integrating the External Secrets Operator with KubeRocketCI for secure and efficient secrets management using Kubernetes Secrets and AWS Systems Manager Parameter Store.","source":"@site/docs/operator-guide/secrets-management/external-secrets-operator-integration.md","sourceDirName":"operator-guide/secrets-management","slug":"/operator-guide/secrets-management/external-secrets-operator-integration","permalink":"/docs/next/operator-guide/secrets-management/external-secrets-operator-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/KubeRocketCI/docs/edit/main/docs/operator-guide/secrets-management/external-secrets-operator-integration.md","tags":[],"version":"current","lastUpdatedBy":"Sergiy Kulanov","lastUpdatedAt":1740847812000,"frontMatter":{"title":"External Secrets Operator Integration","description":"Guide on integrating the External Secrets Operator with KubeRocketCI for secure and efficient secrets management using Kubernetes Secrets and AWS Systems Manager Parameter Store.","sidebar_label":"External Secrets Operator Integration"},"sidebar":"operatorGuideSidebar","previous":{"title":"Install External Secrets Operator","permalink":"/docs/next/operator-guide/secrets-management/install-external-secrets-operator"},"next":{"title":"Security and Compliance Overview","permalink":"/docs/next/operator-guide/devsecops/overview"}}');var s=n(74848),a=n(28453);const i={title:"External Secrets Operator Integration",description:"Guide on integrating the External Secrets Operator with KubeRocketCI for secure and efficient secrets management using Kubernetes Secrets and AWS Systems Manager Parameter Store.",sidebar_label:"External Secrets Operator Integration"},l="External Secrets Operator Integration",c={},o=[{value:"Platform Core Secrets",id:"platform-core-secrets",level:2},{value:"Kubernetes Provider",id:"kubernetes-provider",level:2},{value:"AWS Systems Manager Parameter Store",id:"aws-systems-manager-parameter-store",level:2},{value:"AWS Parameter Store Scenario in KubeRocketCI",id:"aws-parameter-store-scenario-in-kuberocketci",level:3},{value:"Related Articles",id:"related-articles",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components},{Details:r,Head:i}=t;return r||x("Details",!0),i||x("Head",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"external-secrets-operator-integration",children:"External Secrets Operator Integration"})}),"\n",(0,s.jsx)(i,{children:(0,s.jsx)("link",{rel:"canonical",href:"https://docs.kuberocketci.io/docs/operator-guide/secrets-management/external-secrets-operator-integration"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://external-secrets.io/",children:"External Secrets Operator (ESO)"})," can be integrated with KubeRocketCI."]}),"\n",(0,s.jsxs)(t.p,{children:["There are ",(0,s.jsx)(t.a,{href:"https://external-secrets.io/latest/introduction/stability-support",children:"multiple Secrets Providers"})," that can be used within ESO. On this page, we detail the integration of KubeRocketCI with the two foremost providers:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://kubernetes.io/docs/concepts/configuration/secret/",children:"Kubernetes Secrets"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html",children:"AWS Systems Manager Parameter Store"})}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"KubeRocketCI leverages a variety of secrets to facilitate the integration of different solutions. This document provides a comprehensive overview of the secrets utilized within the KubeRocketCI platform, along with their respective descriptions. Please note that all secrets are encoded in Base64 format."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Secret Name"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Fields"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Used by"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"keycloak"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["username",(0,s.jsx)("br",{}),"password"]}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Username and password with ",(0,s.jsx)(t.a,{href:"/docs/next/operator-guide/auth/keycloak#configuration",children:"specific permissions"})," for the Platform tenant management in Keycloak"]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"keycloak-operator"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"ci-defectdojo"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["token",(0,s.jsx)("br",{}),"url"]}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["DefectDojo token",(0,s.jsx)("br",{}),"DefectDojo URL"]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"edp-tekton"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"kaniko-docker-config"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:".dockerconfigjson"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Serialized JSON that follows docker config patterns"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"edp-tekton"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"regcred"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:".dockerconfigjson"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Serialized JSON that follows docker config patterns"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"cd-pipeline-operator"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"ci-github"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["id_rsa",(0,s.jsx)("br",{}),"token",(0,s.jsx)("br",{}),"secretString"]}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Private key from github repo ",(0,s.jsx)("br",{}),"API token",(0,s.jsx)("br",{}),"Random string"]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"edp-tekton"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"ci-gitlab"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["id_rsa",(0,s.jsx)("br",{}),"token",(0,s.jsx)("br",{}),"secretString"]}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Private key from gitlab repo ",(0,s.jsx)("br",{}),"API token",(0,s.jsx)("br",{}),"Random string"]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"edp-tekton"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"ci-bitbucket"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["id_rsa",(0,s.jsx)("br",{}),"token",(0,s.jsx)("br",{}),"secretString"]}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Private key from bitbucket repo ",(0,s.jsx)("br",{}),"App Password",(0,s.jsx)("br",{}),"Random string"]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"edp-tekton"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"ci-jira"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["username",(0,s.jsx)("br",{}),"password"]}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Jira username ",(0,s.jsx)("br",{}),"Jira password"]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"edp-codebase-operator"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"ci-sonarqube"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["token",(0,s.jsx)("br",{}),"url"]}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["SonarQube token",(0,s.jsx)("br",{}),"SonarQube URL"]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"edp-tekton"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"ci-nexus"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["username",(0,s.jsx)("br",{}),"password",(0,s.jsx)("br",{}),"url"]}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Nexus username",(0,s.jsx)("br",{}),"Nexus password",(0,s.jsx)("br",{}),"Nexus URL"]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"edp-tekton"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"ci-dependency-track"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["token",(0,s.jsx)("br",{}),"url",(0,s.jsx)("br",{})]}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Dependency-Track token",(0,s.jsx)("br",{}),"Dependency-Track URL",(0,s.jsx)("br",{})]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"edp-tekton"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"oauth2-proxy-cookie-secret"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"cookie-secret"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Secret key for oauth2-proxy"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"edp-install"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"keycloak-client-headlamp-secret"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"clientSecret"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Secret key for keycloak client"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"keycloak-operator"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"ci-argocd"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["token",(0,s.jsx)("br",{}),"url",(0,s.jsx)("br",{})]}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Argo CD token",(0,s.jsx)("br",{}),"Argo CD URL",(0,s.jsx)("br",{})]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"edp-tekton"})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"platform-core-secrets",children:"Platform Core Secrets"}),"\n",(0,s.jsx)(t.p,{children:"The list below represents the baseline required for full operation within platform core components:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"kaniko-docker-config: Used for pushing container images to a specific registry."}),"\n",(0,s.jsx)(t.li,{children:"ci-sonarqube: Used in the CI process for SonarQube integration."}),"\n",(0,s.jsx)(t.li,{children:"ci-nexus: Used for pushing artifacts to the Nexus storage."}),"\n"]}),"\n",(0,s.jsx)(t.admonition,{type:"warning",children:(0,s.jsx)(t.p,{children:"These secrets are mandatory for Tekton pipelines to work properly."})}),"\n",(0,s.jsx)(t.h2,{id:"kubernetes-provider",children:"Kubernetes Provider"}),"\n",(0,s.jsx)(t.p,{children:"All secrets are stored in Kubernetes in pre-defined namespaces. Platform suggests using the following approach for secrets management:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"EDP_NAMESPACE-vault"}),", where ",(0,s.jsx)(t.code,{children:"EDP_NAMESPACE"})," is a name of the namespace where KubeRocketCI is deployed, such as ",(0,s.jsx)(t.code,{children:"edp-vault"}),". This namespace is used by the platform. Access to secrets in the ",(0,s.jsx)(t.code,{children:"edp-vault"})," is granted only for ",(0,s.jsx)(t.code,{children:"Administrators"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"EDP_NAMESPACE-cicd-vault"}),", where ",(0,s.jsx)(t.code,{children:"EDP_NAMESPACE"})," is a name of the namespace where KubeRocketCI is deployed, such as ",(0,s.jsx)(t.code,{children:"edp-cicd-vault"}),". Development team uses secrets in the ",(0,s.jsx)(t.code,{children:"edp-cicd-vault"})," for microservices development."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"See a diagram below for more details:"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"eso-with-kubernetes",src:n(2082).A+"",width:"1554",height:"804"})}),"\n",(0,s.jsxs)(t.p,{children:["In order to ",(0,s.jsx)(t.a,{href:"/docs/next/operator-guide/install-kuberocketci",children:"Install KubeRocketCI"}),", a list of passwords must be created. Secrets are provided automatically when using ESO."]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Create a common namespace for secrets and platform:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"kubectl create namespace edp-vault\nkubectl create namespace edp\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Create secrets in the ",(0,s.jsx)(t.code,{children:"edp-vault"})," namespace:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Secret\nmetadata:\n  name: keycloak\n  namespace: edp-vault\ndata:\n  password: cGFzcw==  # pass in base64\n  username: dXNlcg==  # user in base64\ntype: Opaque\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["In the ",(0,s.jsx)(t.code,{children:"edp-vault"})," namespace, create a Role with a permission to read secrets:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:'apiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  namespace: edp-vault\n  name: external-secret-store\nrules:\n- apiGroups: [""]\n  resources:\n  - secrets\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - authorization.k8s.io\n  resources:\n  - selfsubjectrulesreviews\n  verbs:\n  - create\n'})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["In the ",(0,s.jsx)(t.code,{children:"edp-vault"})," namespace, create a ServiceAccount used by ",(0,s.jsx)(t.code,{children:"SecretStore"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:"apiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: secret-manager\n  namespace: edp\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Connect the Role from the ",(0,s.jsx)(t.code,{children:"edp-vault"})," namespace with the ServiceAccount in the ",(0,s.jsx)(t.code,{children:"edp"})," namespace:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:"apiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: eso-from-edp\n  namespace: edp-vault\nsubjects:\n  - kind: ServiceAccount\n    name: secret-manager\n    namespace: edp\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: external-secret-store\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Create a SecretStore in the ",(0,s.jsx)(t.code,{children:"edp"})," namespace, and use ServiceAccount for authentication:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:"apiVersion: external-secrets.io/v1beta1\nkind: SecretStore\nmetadata:\n  name: edp-vault\n  namespace: edp\nspec:\n  provider:\n    kubernetes:\n      remoteNamespace: edp-vault  # namespace with secrets\n      auth:\n        serviceAccount:\n          name: secret-manager\n      server:\n        caProvider:\n          type: ConfigMap\n          name: kube-root-ca.crt\n          key: ca.crt\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Each secret must be defined by the ",(0,s.jsx)(t.code,{children:"ExternalSecret"})," object. A code example below creates the ",(0,s.jsx)(t.code,{children:"keycloak"})," secret in the ",(0,s.jsx)(t.code,{children:"edp"})," namespace based on a secret with the same name in the ",(0,s.jsx)(t.code,{children:"edp-vault"})," namespace:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:"apiVersion: external-secrets.io/v1beta1\nkind: ExternalSecret\nmetadata:\n  name: keycloak\n  namespace: edp\nspec:\n  refreshInterval: 1h\n  secretStoreRef:\n    kind: SecretStore\n    name: edp-vault\n  # target:\n  #   name: secret-to-be-created  # name of the k8s Secret to be created. metadata.name used if not defined\n  data:\n  - secretKey: username       # key to be created\n    remoteRef:\n      key: keycloak           # remote secret name\n      property: username      # value will be fetched from this field\n  - secretKey: password       # key to be created\n    remoteRef:\n      key: keycloak           # remote secret name\n      property: password      # value will be fetched from this field\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Apply the same approach for enabling secrets management in the namespaces used for microservices development, such as ",(0,s.jsx)(t.code,{children:"sit"})," and ",(0,s.jsx)(t.code,{children:"qa"})," on the diagram above."]}),"\n",(0,s.jsx)(t.h2,{id:"aws-systems-manager-parameter-store",children:"AWS Systems Manager Parameter Store"}),"\n",(0,s.jsxs)(t.p,{children:["AWS SSM Parameter Store can be used as a ",(0,s.jsx)(t.a,{href:"https://external-secrets.io/latest/provider/aws-parameter-store",children:"Secret Provider for ESO"}),". For the platform, it is recommended to use the ",(0,s.jsx)(t.a,{href:"https://external-secrets.io/latest/provider/aws-parameter-store/#eks-service-account-credentials",children:"IAM Roles For Service Accounts approach"})," (see a diagram below)."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"eso-with-ssm",src:n(55393).A+"",width:"1760",height:"1496"})}),"\n",(0,s.jsx)(t.h3,{id:"aws-parameter-store-scenario-in-kuberocketci",children:"AWS Parameter Store Scenario in KubeRocketCI"}),"\n",(0,s.jsxs)(t.p,{children:["In order to ",(0,s.jsx)(t.a,{href:"/docs/next/operator-guide/install-kuberocketci",children:"Install KubeRocketCI"}),", a list of passwords must be created. Follow the steps below, to get secrets from the SSM:"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["In the AWS, create an AWS IAM policy and an IAM role used by ",(0,s.jsx)(t.code,{children:"ServiceAccount"})," in ",(0,s.jsx)(t.code,{children:"SecretStore"}),". The IAM role must have permissions to get values from the SSM Parameter Store."]}),"\n",(0,s.jsxs)(t.p,{children:["a. Create an IAM policy that allows to get values from the Parameter Store with the ",(0,s.jsx)(t.code,{children:"edp/"})," path. Use your ",(0,s.jsx)(t.code,{children:"AWS Region"})," and ",(0,s.jsx)(t.code,{children:"AWS Account Id"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n"Version": "2012-10-17",\n"Statement": [\n    {\n        "Sid": "VisualEditor0",\n        "Effect": "Allow",\n        "Action": "ssm:GetParameter*",\n        "Resource": "arn:aws:ssm:eu-central-1:012345678910:parameter/edp/*"\n    }\n]\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["b. Create an AWS IAM role with trust relationships (defined below) and attach the IAM policy. Put your string for ",(0,s.jsx)(t.code,{children:"Federated"})," value (",(0,s.jsx)(t.a,{href:"/docs/next/operator-guide/infrastructure-providers/aws/enable-irsa",children:"see more"})," on IRSA enablement for EKS Cluster) and AWS region."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Effect": "Allow",\n            "Principal": {\n                "Federated": "arn:aws:iam::012345678910:oidc-provider/oidc.eks.eu-central-1.amazonaws.com/id/XXXXXXXXXXXXXXXXXX"\n            },\n            "Action": "sts:AssumeRoleWithWebIdentity",\n            "Condition": {\n                "StringLike": {\n                    "oidc.eks.eu-central-1.amazonaws.com/id/XXXXXXXXXXXXXXXXXX:sub": "system:serviceaccount:edp:*"\n                }\n            }\n        }\n    ]\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Create a secret in the AWS Parameter Store with the name ",(0,s.jsx)(t.code,{children:"/edp/my-json-secret"}),". This secret is represented as a parameter of type string within the AWS Parameter Store:"]}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)("b",{children:"View: Parameter Store JSON"})}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "keycloak":\n  {\n    "username": "keycloak-username",\n    "password": "keycloak-password"\n  },\n  "ci-defectdojo":\n  {\n    "token": "XXXXXXXXXXXX",\n    "url": "https://defectdojo.example.com"\n  },\n  "kaniko-docker-config":\n  {\n    "auths" :\n    {\n      "registry.com":\n      {\n        "username":"registry-username",\n        "password":"registry-password",\n        "auth": "<base64 encoded \'user:secret\' string>"\n      }\n  }},\n  "regcred":\n  {\n      "auths":\n      {\n        "registry.com":\n        {\n          "username":"registry-username",\n          "password":"registry-password",\n          "auth":"<base64 encoded \'user:secret\' string>"\n        }\n  }},\n  "ci-github":\n  {\n    "id_rsa": "id-rsa-key",\n    "token": "github-token",\n    "secretString": "XXXXXXXXXXXX"\n  },\n  "ci-gitlab":\n  {\n    "id_rsa": "id-rsa-key",\n    "token": "gitlab-token",\n    "secretString": "XXXXXXXXXXXX"\n  },\n  "ci-jira":\n  {\n    "username": "jira-username",\n    "password": "jira-password"\n  },\n  "ci-sonarqube":\n  {\n    "username": "<ci-user>",\n    "secret": "<secret>"\n  },\n  "ci-nexus":\n  {\n    "username": "<ci.user>",\n    "password": "<secret>"\n  },\n  "oauth2-proxy-cookie-secret":\n  {\n    "cookie-secret": "XXXXXXXXXXXX"\n  },\n  "keycloak-client-headlamp-secret": "XXXXXXXXXXXX",\n  "ci-argocd":\n  {\n    "token": "argocd-token",\n    "url": "https://argocd.example.com"\n  },\n  "ci-dependency-track":\n  {\n    "token": "dependency-track-token",\n    "url": "https://dependency-track.example.com"\n  }\n}\n'})})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Set External Secret operator enabled by updating the values.yaml file:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",metastring:"install values.yaml",children:"externalSecrets:\n  enabled: true\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Install/upgrade edp-install:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"helm upgrade --install edp epamedp/edp-install --wait --timeout=900s \\\n--version <edp_version> \\\n--values values.yaml \\\n--namespace edp \\\n--atomic\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"related-articles",children:"Related Articles"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"/docs/next/operator-guide/secrets-management/install-external-secrets-operator",children:"Install External Secrets Operator"})}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}function x(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},2082:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/eso-k8s-2a68fb961f9b87295117a5c5fa23f0f4.png"},55393:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/eso-ssm-49ead7e22f20ab7f8f90103905db4d6c.png"},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>l});var r=n(96540);const s={},a=r.createContext(s);function i(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);